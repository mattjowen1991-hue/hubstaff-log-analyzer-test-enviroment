<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Hubstaff Client Log Analyzer</title>
  <link rel="stylesheet" href="css/styles.css">
</head>
<body>
  <header>
    <h1>üîÆ Hubstaff Client Log Analyzer</h1>
    <p>Analyze hubstaff.log files to diagnose tracking issues, crashes, network errors, and more.</p>
    <p style="font-size:11px; color:var(--success); margin-top:4px;">üîí Privacy: All analysis happens in your browser. No data is sent anywhere.</p>
  </header>

  <main>
    <div class="card">
      <div class="controls">
        <button class="primary" id="analyzeBtn">üîç Analyze</button>
        <button id="clearBtn">Clear</button>
        <span class="status" id="status"></span>
      </div>
      
      <!-- Input Method Toggle -->
      <div class="input-method-toggle">
        <div class="input-method-btn active" id="uploadMethodBtn">üìÅ Upload File</div>
        <div class="input-method-btn" id="pasteMethodBtn">üìã Paste Text</div>
      </div>
      
      <!-- File Upload Section -->
      <div class="input-section active" id="uploadSection">
        <div class="file-upload-area" id="fileUploadArea">
          <input type="file" id="fileInput" accept=".log,.txt,.1,.2,.3,.4,.5,.6,.7,.8,.9" multiple>
          <div class="file-upload-icon">üìÑ</div>
          <div class="file-upload-text"><strong>Click to upload</strong> or drag & drop</div>
          <div class="file-upload-hint">Supports multiple files ‚Äî drop all your hubstaff.log, hubstaff.1, helper_hubstaff.log, audit.log files at once</div>
          <div class="file-name-display" id="fileName"></div>
        </div>
        <div class="progress-container" id="progressContainer">
          <div class="progress-bar-bg">
            <div class="progress-bar" id="progressBar"></div>
          </div>
          <div class="progress-text" id="progressText">Processing...</div>
        </div>
      </div>
      
      <!-- Paste Text Section -->
      <div class="input-section" id="pasteSection">
        <textarea id="logInput" placeholder="Paste raw hubstaff.log contents here - noise will be filtered automatically..."></textarea>
      </div>
      <div class="toggle-row">
  <label class="has-tooltip"><input type="checkbox" id="autoFilter" checked> Auto-filter noise<span class="tooltip">Removes routine log lines (mouse coordinates, heartbeats, successful API calls) that don't help diagnose issues. Keeps errors, warnings, screenshots, and tracking events. Disable if you need to see every raw log line.</span></label>
  <label class="has-tooltip"><input type="checkbox" id="plainMode" checked> üéØ Plain English mode<span class="tooltip">Translates technical log messages into plain English explanations with actionable advice. Shows the Root Cause Analysis box and Quick Summary. Disable for raw technical view.</span></label>
        <label class="has-tooltip"><input type="checkbox" id="showDebug"> Show DEBUG level<span class="tooltip">DEBUG logs show detailed app operations like API calls, file reads, and internal processes. Usually only needed for deep technical investigation.</span></label>
        <label class="has-tooltip"><input type="checkbox" id="showTrace"> Show TRACE level<span class="tooltip">TRACE logs show very granular details like every mouse movement and keystroke. Creates a lot of noise - only enable if specifically needed.</span></label>
        <span class="help-link" id="helpBtn">Help & Info</span>
      </div>

      <!-- Timezone & Date Filter Controls -->
      <div class="filter-controls">
        <label class="has-tooltip" style="cursor:pointer;">
          <input type="checkbox" id="userTzMode"> Show in user's timezone
          <span class="tooltip tooltip-bottom">Convert all times from your local timezone to the user's timezone. Enter their UTC offset below. A ‚òÖ will appear next to converted times.</span>
        </label>
        <div class="tz-input-group">
          <span style="font-size:11px; color:var(--muted);">User's offset:</span>
          <input type="text" id="tzOffset" placeholder="e.g. -05:00">
          <span class="tz-label" id="tzLabel"></span>
        </div>
        <div class="date-filter-group">
          <label>Filter dates:</label>
          <input type="date" id="dateFrom" title="From date">
          <span>to</span>
          <input type="date" id="dateTo" title="To date">
          <button id="clearDates">Clear</button>
        </div>
      </div>
      
      <div id="filterStats" class="filter-stats-box" style="display:none;">
        <div class="filter-stats-header">
          <span id="filterStatsText"></span>
          <span class="filter-toggle" id="filterDetailsToggle" onclick="toggleFilterDetails()">What was removed?</span>
        </div>
        <div id="filterDetails" class="filter-details" style="display:none;">
          <p><strong>Noise patterns removed:</strong></p>
          <ul>
            <li><code>WindowsInput.cpp</code> - Mouse/keyboard coordinates logged every second</li>
            <li><code>InputExtension.h</code> - Routine input tracking checks</li>
            <li><code>Heart beat</code> - Keep-alive messages sent regularly</li>
            <li><code>Response: 200/201/204</code> - Successful API calls (we keep errors)</li>
            <li><code>Check CURL Response</code> - Routine network checks</li>
            <li><code>StorageIO.*Wrote</code> - Routine database writes (except Location/TrackedActivity)</li>
            <li><code>Storage.h.*Read</code> - Routine database reads</li>
            <li><code>HelperClient.cpp</code> - Routine extension checks (unless contains URL/APP)</li>
          </ul>
          <p><strong>Why filter?</strong> These lines appear hundreds/thousands of times and don't help diagnose issues. The "signal" (errors, warnings, screenshots, tracking events) is preserved.</p>
        </div>
      </div>
      <div class="search-box" style="margin-top:12px;">
        <div class="search-input-wrapper has-tooltip">
          <input type="text" id="searchInput" placeholder="Search logs (e.g., 'error', 'screenshot', 'URL:')...">
          <span class="tooltip tooltip-bottom">
            <strong>üîé Search Tips:</strong><br><br>
            Search through ALL log lines (even filtered ones) for specific text.<br><br>
            <strong>Useful searches:</strong><br>
            ‚Ä¢ <code>error</code> - Find all errors<br>
            ‚Ä¢ <code>URL:</code> - Find tracked websites<br>
            ‚Ä¢ <code>TITLE:</code> - Find window titles<br>
            ‚Ä¢ <code>Discard</code> - Find rejected time<br>
            ‚Ä¢ <code>screenshot</code> - Find capture events<br>
            ‚Ä¢ <code>watchdog</code> - Find freeze events<br>
            ‚Ä¢ <code>Response: 5</code> - Find server errors<br><br>
            <em>Results auto-expand below. Max 200 results shown.</em>
          </span>
        </div>
        <button id="searchBtn">Search</button>
        <button id="clearSearchBtn">Clear</button>
      </div>
    </div>

    <div class="kpis" id="kpiSection">
      <div class="kpi"><div class="kpi-label">Total Lines</div><div class="kpi-value" id="kpiTotal">0</div></div>
      <div class="kpi"><div class="kpi-label">Errors</div><div class="kpi-value danger" id="kpiErrors">0</div></div>
      <div class="kpi"><div class="kpi-label">Warnings</div><div class="kpi-value warn" id="kpiWarnings">0</div></div>
      <div class="kpi"><div class="kpi-label">Tracked Time</div><div class="kpi-value success" id="kpiTrackedTime">0:00:00</div></div>
      <div class="kpi"><div class="kpi-label">Idle Kept</div><div class="kpi-value" id="kpiIdleKept">0:00:00</div></div>
      <div class="kpi"><div class="kpi-label">Idle Discarded</div><div class="kpi-value warn" id="kpiIdleDisc">0:00:00</div></div>
      <div class="kpi"><div class="kpi-label">Timezone</div><div class="kpi-value" id="kpiTimezone">--</div></div>
      <div class="kpi"><div class="kpi-label">Log Time Span</div><div class="kpi-value" id="kpiTimeSpan">--</div></div>
    </div>

    <div id="rootCauseCard" style="display:none;"></div>
    
    <div id="deviceDashboard" style="display:none;"></div>

    <div id="silentAppDashboard" style="display:none;"></div>

    <div class="card" id="summaryCard" style="display:none; border-left: 3px solid var(--accent);">
      <div class="section-title"><span>üìã</span> Quick Summary for Support</div>
      <div id="summaryContent"></div>
    </div>

    <div class="collapsible-section" id="sessionsCard" style="display:none;">
      <div class="collapsible-header" onclick="toggleSection('sessions')">
        <h3><span>‚è±Ô∏è</span> Tracking Sessions</h3>
        <div class="header-meta">
          <span class="badge" id="sessionsCount">0</span>
          <span class="chevron">‚ñº</span>
        </div>
      </div>
      <div class="collapsible-content" id="sessionsContent">
        <div id="authenticatedUsersPanel" style="display:none; margin-bottom:12px; padding:12px; background:var(--card); border:1px solid var(--border); border-radius:8px;">
          <div style="display:flex; align-items:center; justify-content:space-between; margin-bottom:8px;">
            <div style="font-size:13px; font-weight:600; color:var(--link);">üë§ Authenticated Users</div>
            <span class="badge" id="authUserCount" style="background:var(--accent-dim);">0</span>
          </div>
          <div id="authenticatedUsersList"></div>
          <div id="multiUserWarning" style="display:none; margin-top:8px; padding:8px; background:rgba(245,158,11,0.1); border:1px solid var(--warn); border-radius:6px; font-size:11px; color:var(--warn);">
            ‚ö†Ô∏è <strong>Multiple users detected on this client.</strong> This may indicate shared device usage or member switching. Check if time was tracked under the wrong account.
          </div>
        </div>
        <div id="sessionExplainer" class="explainer-box" style="display:none;"></div>
        <div class="table-wrap" style="max-height:300px;">
          <table>
            <thead><tr><th>#</th><th>Start</th><th>Stop</th><th>Duration</th><th>Stop Reason</th></tr></thead>
            <tbody id="sessionsBody"></tbody>
          </table>
        </div>
        <div id="stopReasonLegend" class="legend-box-inline" style="margin-top:10px; font-size:11px; color:var(--muted); display:none;">
          <strong>Stop Reasons:</strong> 
          <span class="tag success" style="margin-left:8px;">User stopped</span> = Normal stop, logged by app as user-initiated. 
          <span class="tag warn" style="margin-left:8px;">Went idle</span> = Idle timeout triggered. 
          <span class="tag error" style="margin-left:8px;">‚ö†Ô∏è Crashed</span> = No stop event found, likely crashed.
          <span style="margin-left:8px;">‚ö° = Very short session (&lt;30s)</span>
        </div>
        <div style="margin-top:12px; padding-top:12px; border-top:1px dashed var(--border);">
          <div class="section-title" style="margin-bottom:8px;"><span>üí§</span> Idle Time Decisions</div>
          <div class="table-wrap" style="max-height:300px;">
            <table>
              <thead><tr><th>Time</th><th>Idle Duration</th><th>Response Time</th><th>User Action</th><th>Raw Values</th></tr></thead>
              <tbody id="idleBody"></tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <div class="card timeline-section" id="timelineSection" style="display:none;">
      <div class="timeline-header">
        <div class="section-title" style="margin:0;"><span>üìä</span> Event Timeline</div>
        <div class="timeline-legend">
          <label class="legend-toggle"><input type="checkbox" id="togErrors" checked><div class="legend-box" style="background:var(--danger)"></div> Errors</label>
          <label class="legend-toggle"><input type="checkbox" id="togWarnings" checked><div class="legend-box" style="background:var(--warn)"></div> Warnings</label>
          <label class="legend-toggle"><input type="checkbox" id="togScreenshots" checked><div class="legend-box" style="background:var(--accent)"></div> Screenshots</label>
          <label class="legend-toggle"><input type="checkbox" id="togNetwork" checked><div class="legend-box" style="background:var(--info)"></div> Network</label>
          <label class="legend-toggle"><input type="checkbox" id="togLocation" checked><div class="legend-box" style="background:#10b981"></div> Location</label>
          <label class="legend-toggle"><input type="checkbox" id="togTracking" checked><div class="legend-box" style="background:var(--link)"></div> Tracking</label>
        </div>
        <div class="zoom-controls">
          <label>Zoom:</label>
          <input type="range" id="zoomSlider" min="1" max="20" value="1" step="0.5">
          <button id="resetZoom">Reset</button>
        </div>
      </div>
      <div class="timeline-container" id="timelineContainer">
        <div class="timeline-content" id="timelineContent">
          <div class="timeline-label" id="labelErrors">Errors <span class="count" id="tlErrorCount">0</span></div>
          <div class="timeline-track" id="trackErrors"></div>
          <div class="timeline-label" id="labelWarnings">Warnings <span class="count" id="tlWarnCount">0</span></div>
          <div class="timeline-track" id="trackWarnings"></div>
          <div class="timeline-label" id="labelScreenshots">Screenshots <span class="count" id="tlScreenCount">0</span></div>
          <div class="timeline-track" id="trackScreenshots"></div>
          <div class="timeline-label" id="labelNetwork">Network <span class="count" id="tlNetCount">0</span></div>
          <div class="timeline-track" id="trackNetwork"></div>
          <div class="timeline-label" id="labelLocation">Location <span class="count" id="tlLocCount">0</span></div>
          <div class="timeline-track" id="trackLocation"></div>
          <div class="timeline-label" id="labelTracking">Tracking <span class="count" id="tlTrackCount">0</span></div>
          <div class="timeline-track" id="trackTracking"></div>
          <div class="timeline-time-axis" id="timeAxis"></div>
        </div>
      </div>
    </div>

    <div class="grid-2">
      <div class="collapsible-section">
        <div class="collapsible-header" onclick="toggleSection('errors')">
          <h3><span>üö®</span> Errors & Critical Issues</h3>
          <div class="header-meta">
            <span class="badge danger" id="errorsCount">0</span>
            <span class="chevron">‚ñº</span>
          </div>
        </div>
        <div class="collapsible-content" id="errorsContent">
          <div class="category-content" id="errorsList" style="max-height:350px; overflow-y:auto;"></div>
        </div>
      </div>

      <div class="collapsible-section">
        <div class="collapsible-header" onclick="toggleSection('warnings')">
          <h3><span>‚ö†Ô∏è</span> Warnings & Anomalies</h3>
          <div class="header-meta">
            <span class="badge warn" id="warningsCount">0</span>
            <span class="chevron">‚ñº</span>
          </div>
        </div>
        <div class="collapsible-content" id="warningsContent">
          <div class="category-content" id="warningsList" style="max-height:350px; overflow-y:auto;"></div>
        </div>
      </div>
    </div>

    <div class="collapsible-section">
      <div class="collapsible-header collapsed" onclick="toggleSection('screenshots')">
        <h3><span>üì∏</span> Screenshots & Screen Capture</h3>
        <div class="header-meta">
          <span class="badge" id="screenshotsCount">0</span>
          <span class="badge" id="screenshotHealthBadge" style="display:none;background:#e74c3c;color:#fff;margin-left:4px;">‚ö†Ô∏è Issues</span>
          <span class="chevron">‚ñº</span>
        </div>
      </div>
      <div class="collapsible-content collapsed" id="screenshotsContent">
        <div id="screenshotHealthPanel" style="display:none;margin-bottom:12px;"></div>
        <div class="table-wrap" style="max-height:250px;">
          <table>
            <thead><tr><th>Time</th><th>Event</th><th>Details</th></tr></thead>
            <tbody id="screenshotsBody"></tbody>
          </table>
        </div>
      </div>
    </div>

    <div class="collapsible-section">
      <div class="collapsible-header collapsed" onclick="toggleSection('network')">
        <h3><span>üåê</span> Network & API Activity</h3>
        <div class="header-meta">
          <span class="badge" id="networkCount">0</span>
          <span class="chevron">‚ñº</span>
        </div>
      </div>
      <div class="collapsible-content collapsed" id="networkContent">
        <div class="table-wrap" style="max-height:250px;">
          <table>
            <thead><tr><th>Time</th><th>Status</th><th>Details</th></tr></thead>
            <tbody id="networkBody"></tbody>
          </table>
        </div>
      </div>
    </div>

    <div class="collapsible-section">
      <div class="collapsible-header collapsed" onclick="toggleSection('locations')">
        <h3><span>üìç</span> Locations & Job Sites</h3>
        <div class="header-meta">
          <span class="badge" id="locationsCount">0</span>
          <span class="chevron">‚ñº</span>
        </div>
      </div>
      <div class="collapsible-content collapsed" id="locationsContent">
        <div id="visitHistorySection"></div>
        <div class="table-wrap" style="max-height:200px;">
          <table>
            <thead><tr><th>Time</th><th>Event</th><th>Details</th></tr></thead>
            <tbody id="locationsBody"></tbody>
          </table>
        </div>
      </div>
    </div>

    <div class="collapsible-section">
      <div class="collapsible-header collapsed" onclick="toggleSection('apps')">
        <h3><span>üñ•Ô∏è</span> URLs & Applications</h3>
        <div class="header-meta">
          <span class="badge" id="appsCount">0</span>
          <span class="chevron">‚ñº</span>
        </div>
      </div>
      <div class="collapsible-content collapsed" id="appsContent">
        <div class="table-wrap" style="max-height:250px;">
          <table>
            <thead><tr><th>Time</th><th>Type</th><th>Content</th></tr></thead>
            <tbody id="appsBody"></tbody>
          </table>
        </div>
      </div>
    </div>

    <div class="collapsible-section">
      <div class="collapsible-header collapsed" onclick="toggleSection('injected')">
        <h3><span>ü§ñ</span> Injected / Simulated Input Activity</h3>
        <div class="header-meta">
          <span class="badge" id="injectedCount">0</span>
          <span class="chevron">‚ñº</span>
        </div>
      </div>
      <div class="collapsible-content collapsed" id="injectedContent">
        <div id="injectedExplainer" class="explainer-box">
          <h4>What is "Injected Input" and "Simulated Input"?</h4>
          <p>Windows can detect when keyboard/mouse input comes from software rather than physical devices:</p>
          <ul>
            <li><strong>Real input (R)</strong> - Actual keyboard/mouse from the user</li>
            <li><strong>Injected input (I)</strong> - Software-generated input from another process</li>
            <li><strong>Low-integrity injected (LI)</strong> - Input from unverified/untrusted sources</li>
          </ul>
          <h4 style="margin-top:12px;">What is "Simulating missed input"?</h4>
          <p>This occurs when Hubstaff detects activity happened but couldn't identify the source via normal detection methods. Since the source is unknown, activity is "simulated" for both mouse and keyboard.</p>
          <p><strong>üîß Common causes of simulated input:</strong></p>
          <ul>
            <li>Drawing tablets / graphics tablets (Wacom, XP-Pen, Huion, etc.)</li>
<li>Stylus pens / touchscreens</li>
<li>Gaming mice or keyboards with high polling rates (1000Hz+)</li>
<li>Gaming peripherals with custom drivers or software (Razer, Logitech G, Corsair, etc.)</li>
<li>Non-standard mice or keyboards</li>
<li>KVM switches</li>
<li>USB hubs or docking stations causing device recognition issues</li>>
          </ul>
          <p><strong>üõ†Ô∏è Troubleshooting high activity from simulated input:</strong></p>
          <ol>
            <li>Ask the user to list ALL connected devices (including tablets, pens, touchscreens)</li>
            <li>Have them disconnect all devices except mouse and keyboard</li>
            <li>Monitor activity levels for 10 minutes</li>
            <li>Reconnect devices one by one, checking activity after each</li>
            <li>This isolates which device is causing the issue</li>
          </ol>
          <p><strong>‚ö†Ô∏è Note:</strong> Injected/simulated input is NOT automatically cheating. Check screenshots for legitimacy - if screenshots show real work, it's likely a hardware issue rather than manipulation.</p>
        </div>
        <div class="table-wrap" style="max-height:250px;">
          <table>
            <thead><tr><th>Time</th><th>Type</th><th>Details</th></tr></thead>
            <tbody id="injectedBody"></tbody>
          </table>
        </div>
      </div>
    </div>

    <div class="collapsible-section">
      <div class="collapsible-header collapsed" onclick="toggleSection('tracking')">
        <h3><span>üìù</span> Raw Tracking Events</h3>
        <div class="header-meta">
          <span class="badge" id="trackingCount">0</span>
          <span class="chevron">‚ñº</span>
        </div>
      </div>
      <div class="collapsible-content collapsed" id="trackingContent">
        <div class="table-wrap" style="max-height:250px;">
          <table>
            <thead><tr><th>Time</th><th>Event</th><th>Details</th></tr></thead>
            <tbody id="trackingBody"></tbody>
          </table>
        </div>
      </div>
    </div>

    <div class="collapsible-section">
      <div class="collapsible-header collapsed" onclick="toggleSection('search')">
        <h3><span>üîé</span> Search Results</h3>
        <div class="header-meta">
          <span class="badge" id="searchCount">0</span>
          <span class="chevron">‚ñº</span>
        </div>
      </div>
      <div class="collapsible-content collapsed" id="searchContent">
        <div class="table-wrap" style="max-height:300px;">
          <table>
            <thead><tr><th>Time</th><th>Level</th><th>Source</th><th>Message</th></tr></thead>
            <tbody id="searchBody"></tbody>
          </table>
        </div>
      </div>
    </div>

    <footer>
      <span>Hubstaff Client Log Analyzer</span>
      <span style="margin:0 10px;">|</span>
      <span class="help-link" id="helpGuideBtn">üìñ Help Guide</span>
      <span style="margin:0 10px;">|</span>
      <span class="help-link" id="privacyBtn">üîí Privacy Info</span>
    </footer>
  </main>

  <div class="modal-overlay" id="privacyModal">
    <div class="modal" style="max-width:550px;">
      <button class="close-btn" id="closePrivacy">Close</button>
      <h2>üîí Privacy & Data Security</h2>
      <h3>Your data stays on your device</h3>
      <p>This tool runs <strong>entirely in your web browser</strong>. When you paste log data:</p>
      <ul>
        <li>‚úÖ Data is processed locally on your computer</li>
        <li>‚úÖ Nothing is sent to any server</li>
        <li>‚úÖ No data is stored in cookies or browser storage</li>
        <li>‚úÖ No tracking or analytics</li>
      </ul>
      <h3>What happens when you click "Clear"</h3>
      <ul>
        <li>The text input is emptied</li>
        <li>All parsed data is overwritten in memory</li>
        <li>All displayed results are removed</li>
        <li>A confirmation message appears</li>
      </ul>
      <h3>What happens when you close the page</h3>
      <ul>
        <li>All data is automatically cleared</li>
        <li>Nothing persists after you leave</li>
        <li>No data remains in browser history</li>
      </ul>
      <h3>Best practices</h3>
      <ul>
        <li>Click <strong>"Clear"</strong> when you're done analyzing</li>
        <li>Close the browser tab when finished</li>
        <li>Avoid sharing screenshots that show email addresses or PII</li>
      </ul>
      <div style="background:rgba(34,197,94,0.1); border:1px solid var(--success); border-radius:8px; padding:12px; margin-top:16px;">
        <p style="margin:0; color:var(--success);"><strong>‚úÖ Safe to use with sensitive logs</strong></p>
        <p style="margin:8px 0 0 0; font-size:12px;">This tool is designed for support teams handling customer data. Your logs never leave your browser.</p>
      </div>
    </div>
  </div>

  <div class="info-box" id="infoBox">
    <h4 id="infoTitle">Event Details</h4>
    <div id="infoContent"></div>
  </div>

  <div class="modal-overlay" id="helpModal">
    <div class="modal help-guide">
      <button class="close-btn" id="closeHelp">Close</button>
      <h2>üìñ Hubstaff Client Log Analyzer - Help Guide</h2>
      
      <nav class="help-nav">
        <button class="help-nav-btn active" data-section="overview">Overview</button>
        <button class="help-nav-btn" data-section="interface">Interface</button>
        <button class="help-nav-btn" data-section="silentapp">Silent App</button>
        <button class="help-nav-btn" data-section="screenshots">Screenshots</button>
        <button class="help-nav-btn" data-section="idle">Idle Time</button>
        <button class="help-nav-btn" data-section="sessions">Sessions</button>
        <button class="help-nav-btn" data-section="jobsites">Job Sites</button>
        <button class="help-nav-btn" data-section="ios">iOS</button>
        <button class="help-nav-btn" data-section="android">Android</button>
        <button class="help-nav-btn" data-section="desktop">Desktop</button>
        <button class="help-nav-btn" data-section="patterns">Log Patterns</button>
      </nav>

      <!-- OVERVIEW SECTION -->
      <div class="help-section active" id="help-overview">
        <h3>What This Tool Analyzes</h3>
        <p>This analyzer works with multiple Hubstaff log file types. You can <strong>upload multiple files at once</strong> ‚Äî they'll be auto-sorted chronologically and merged.</p>
        
        <h4>Supported Log Files</h4>
        <table class="help-table">
          <tr><th>File</th><th>Contains</th></tr>
          <tr><td><code>hubstaff.log</code></td><td>Main client log ‚Äî errors, warnings, screenshots, tracking, apps, URLs</td></tr>
          <tr><td><code>hubstaff.1</code> ‚Äì <code>.9</code></td><td>Rotated log files (older data)</td></tr>
          <tr><td><code>helper_hubstaff.log</code></td><td>Helper process ‚Äî memory usage, app detection, screenshot capture</td></tr>
          <tr><td><code>audit.log</code></td><td>Audit events ‚Äî startup, shutdown, tracking, auth (powers the Silent App Dashboard)</td></tr>
        </table>

        <h4>Event Categories</h4>
        <table class="help-table">
          <tr><th>Category</th><th>What's Captured</th></tr>
          <tr><td><strong>Errors & Crashes</strong></td><td>[ERROR] events, watchdog hits, helper crashes, fatal errors</td></tr>
          <tr><td><strong>Warnings</strong></td><td>[WARN] events, discarded time, memory issues</td></tr>
          <tr><td><strong>Screenshots</strong></td><td>Capture events, uploads, failures, and <strong>blank screenshot risk analysis</strong> (permissions, security software, sleep)</td></tr>
          <tr><td><strong>Network</strong></td><td>API responses (especially 4xx/5xx), SSL/TLS errors, rate limiting (429)</td></tr>
          <tr><td><strong>Locations</strong></td><td>Geofence events, permission states, GPS coordinates, visit history</td></tr>
          <tr><td><strong>Apps & URLs</strong></td><td>Tracked apps, websites, window titles, Brave Browser detection</td></tr>
          <tr><td><strong>Injected/Simulated Input</strong></td><td>"Simulating missed input" events indicating hardware recognition issues</td></tr>
          <tr><td><strong>Tracking</strong></td><td>Start/stop, idle, resume, discard, auto-start/stop events</td></tr>
        </table>

        <div class="help-callout">
          <strong>üí° Silent App Detection</strong><br>
          When corporate/enterprise silent app logs are detected (via <code>ENTERPRISE_INSTALL</code>, <code>CORPORATE_LOGIN</code>, or <code>profile corporate</code>), a dedicated <strong>Silent App Health Dashboard</strong> appears automatically with health scoring, lifecycle timeline, and KPI cards. See the <strong>Silent App</strong> tab for details.
        </div>

        <h3>Built-in Noise Filter</h3>
        <p>Enabled by default, this removes routine log lines that don't help with debugging:</p>
        <ul>
          <li><code>WindowsInput.cpp</code> - Mouse/keyboard coordinates</li>
          <li><code>Heart beat</code> - Keep-alive messages</li>
          <li><code>Response: 200/201/204</code> - Successful API calls</li>
          <li><code>StorageIO.*Wrote</code> - Routine database writes</li>
</ul>
<div class="help-callout">
  <strong>üí° Exception:</strong> "Simulating missed input" lines are always kept even though they come from <code>WindowsInput.cpp</code>. These indicate hardware that Hubstaff can't properly recognize (drawing tablets, gaming peripherals, KVM switches, etc.) and can cause unexpectedly high activity levels.
</div>
<p>Uncheck "Auto-filter noise" if you need to see all raw log lines.</p>

<h3>Simulated Input Detection</h3>
<p>The analyzer detects "Simulating missed input" events which occur when Hubstaff sees activity but can't identify the source device. This is important because:</p>
<ul>
  <li>It can cause <strong>artificially high activity rates</strong> (90%+)</li>
  <li>It's usually a <strong>hardware issue, not cheating</strong></li>
  <li>Common causes: drawing tablets, gaming mice/keyboards, touchscreens, KVM switches</li>
</ul>
<p><strong>Troubleshooting:</strong> Have the user disconnect all devices except a basic mouse and keyboard, monitor activity for 10 minutes, then reconnect devices one-by-one to isolate the culprit.</p>

<h3>Privacy</h3>
        <div class="help-callout success">
          <strong>üîí 100% Local Processing</strong><br>
          All analysis happens in your browser. No data is ever sent to any server. Click "Clear" or close the tab to wipe all data from memory.
        </div>
      </div>

      <!-- INTERFACE SECTION -->
      <div class="help-section" id="help-interface">
        <h3>Input Methods</h3>
        <p>Two ways to get log data into the analyzer:</p>
        <table class="help-table">
          <tr><th>Method</th><th>How</th></tr>
          <tr><td><strong>üìÅ Upload File</strong></td><td>Click the upload area or drag & drop files. Supports <strong>multiple files at once</strong> ‚Äî they'll be auto-sorted by timestamp and merged with file boundary markers.</td></tr>
          <tr><td><strong>üìã Paste Text</strong></td><td>Switch to the Paste tab and paste log content directly.</td></tr>
        </table>
        <div class="help-callout">
          <strong>üí° Multi-File Upload</strong><br>
          For best results, upload all related files together: <code>hubstaff.log</code>, <code>hubstaff.1</code>‚Äì<code>.9</code>, <code>helper_hubstaff.log</code>, and <code>audit.log</code>. The analyzer sorts them oldest-first and shows the merge order in the UI.
        </div>

        <h3>KPI Dashboard</h3>
        <table class="help-table">
          <tr><th>Metric</th><th>What It Means</th></tr>
          <tr><td><strong>Total Lines</strong></td><td>Number of log lines analyzed</td></tr>
          <tr><td><strong>Errors</strong></td><td>Count of ERROR-level events</td></tr>
          <tr><td><strong>Warnings</strong></td><td>Count of WARN-level events</td></tr>
          <tr><td><strong>Tracked Time</strong></td><td>Actual time between START and STOP events</td></tr>
          <tr><td><strong>Idle Kept</strong></td><td>Idle time the user chose to keep</td></tr>
          <tr><td><strong>Idle Discarded</strong></td><td>Idle time that was rejected</td></tr>
        </table>

        <h3>Controls</h3>
        <table class="help-table">
          <tr><th>Control</th><th>Purpose</th></tr>
          <tr><td><strong>Auto-filter noise</strong></td><td>Remove routine log lines that don't help diagnose issues</td></tr>
          <tr><td><strong>Plain English mode</strong></td><td>Show translated explanations instead of raw technical data</td></tr>
          <tr><td><strong>Show DEBUG/TRACE</strong></td><td>Include verbose logging levels (rarely needed)</td></tr>
          <tr><td><strong>Show user's timezone</strong></td><td>Convert timestamps to customer's local time (marked with ‚òÖ)</td></tr>
          <tr><td><strong>Filter dates</strong></td><td>Narrow results to a specific date range</td></tr>
        </table>

        <h3>Data Tables & Virtual Scrolling</h3>
        <p>All data tables (screenshots, network, locations, apps, injected input, tracking, search results) use <strong>virtual scrolling</strong> for large datasets. This means you can scroll through thousands of events smoothly ‚Äî all rows are accessible, not just the first 50.</p>

        <h3>Search Tips</h3>
        <p>The search box searches <strong>all</strong> log lines, including filtered ones. All matches are shown with virtual scrolling.</p>
        <ul>
          <li><code>error</code> ‚Äî All error mentions</li>
          <li><code>URL:</code> ‚Äî Tracked websites</li>
          <li><code>screenshot</code> ‚Äî Screen capture events</li>
          <li><code>Discard</code> ‚Äî Rejected time</li>
          <li><code>watchdog</code> ‚Äî App freeze events</li>
          <li><code>Response: 5</code> ‚Äî Server errors (5xx)</li>
          <li><code>Helper died</code> ‚Äî Helper process crashes</li>
          <li><code>CAPTURE_DESKTOP</code> ‚Äî Screen sleep / monitor off events</li>
          <li><code>CORPORATE_PROVISION</code> ‚Äî Silent app provisioning events</li>
          <li><code>Simulating missed</code> ‚Äî Hardware input simulation events</li>
        </ul>
      </div>

      <!-- SILENT APP SECTION -->
      <div class="help-section" id="help-silentapp">
        <h3>Silent App Health Dashboard</h3>
        <p>Automatically appears when corporate/enterprise silent app logs are detected. Provides a comprehensive diagnostic view tailored to silent app issues.</p>

        <h4>Health Score (0‚Äì100)</h4>
        <p>A weighted score based on detected issues. The bar turns from green to red as the score drops:</p>
        <table class="help-table">
          <tr><th>Check</th><th>Penalty</th></tr>
          <tr><td>Version outdated (vs latest)</td><td>-20</td></tr>
          <tr><td>Provision failures (<code>CORPORATE_PROVISION_ATTEMPT_FAILED</code>)</td><td>-25</td></tr>
          <tr><td>Multi-day gaps (app offline &gt;24h)</td><td>-15 each</td></tr>
          <tr><td>Unclean startups (crashes)</td><td>-5 each</td></tr>
          <tr><td>Helper crashes (50+)</td><td>-5 to -10</td></tr>
          <tr><td>Memory pressure (&gt;90%)</td><td>-5 to -10</td></tr>
          <tr><td>Double-starts (crash-restart)</td><td>-10</td></tr>
          <tr><td>SSL/TLS errors</td><td>up to -10</td></tr>
          <tr><td>HTTP 429 rate limiting</td><td>up to -15</td></tr>
          <tr><td>Screenshot blank risk factors</td><td>-5 to -15</td></tr>
        </table>

        <h4>KPI Cards</h4>
        <table class="help-table">
          <tr><th>Card</th><th>What It Shows</th></tr>
          <tr><td><strong>Startups</strong></td><td>Total startups ‚Äî clean vs. crashed (<code>STARTUP_UNCLEAN</code>)</td></tr>
          <tr><td><strong>Shutdowns</strong></td><td>Clean shutdowns and how many from screen sleep</td></tr>
          <tr><td><strong>Multi-Day Gaps</strong></td><td>Periods offline &gt;24 hours ‚Äî the #1 silent app complaint</td></tr>
          <tr><td><strong>Helper Crashes</strong></td><td>Helper process crash count (affects screenshots & app detection)</td></tr>
          <tr><td><strong>Auth Status</strong></td><td>Token auth success or provision failure</td></tr>
          <tr><td><strong>System Memory</strong></td><td>RAM usage from helper_hubstaff.log</td></tr>
          <tr><td><strong>Auto-Track</strong></td><td>Auto-start count and idle timeout count</td></tr>
          <tr><td><strong>Screenshots</strong></td><td>Screenshot health status and blank risk factors</td></tr>
          <tr><td><strong>Rate Limits</strong></td><td>HTTP 429 responses (only appears when detected)</td></tr>
          <tr><td><strong>SSL Errors</strong></td><td>Connection failures (only appears when detected)</td></tr>
        </table>
        <p>Every KPI card has a <strong>hover tooltip</strong> ‚Äî hover over any card for a detailed explanation of what the metric means, why it matters, and what to do.</p>

        <h4>Lifecycle Timeline</h4>
        <p>Shows the app's startup‚Üíshutdown cycles as a collapsible timeline:</p>
        <ul>
          <li>Each cycle: date, uptime duration, tracked time, status tags</li>
          <li>Expandable detail table with colour-coded event badges</li>
          <li>Gap detection: overnight gaps (moon icon) and multi-day gaps (red alert boxes)</li>
          <li>Tags: <code>SCREEN SLEEP</code>, <code>CRASHED START</code>, <code>NO SHUTDOWN</code>, <code>RESUME IGNORED</code>, <code>AUTH FAILED</code>, <code>STOP ERROR</code></li>
        </ul>

        <h4>Common Silent App Issues</h4>
        <table class="help-table">
          <tr><th>Issue</th><th>What to Check</th></tr>
          <tr><td>Multi-day gaps</td><td>PC sleeping and app not restarting. Update to latest version. Check if app is set to auto-start on boot.</td></tr>
          <tr><td><code>CORPORATE_PROVISION_ATTEMPT_FAILED</code></td><td>Auth failure ‚Äî check network, enterprise profile, user account status</td></tr>
          <tr><td>High unclean startups</td><td>App crashing repeatedly ‚Äî check for antivirus interference or memory pressure</td></tr>
          <tr><td>Screen sleep ‚Üí shutdown chain</td><td>Normal end-of-day behaviour. Issue is if app doesn't restart the next day.</td></tr>
          <tr><td>No <code>AUTO_START_STOP</code> events</td><td>Auto-track policy may not be configured for the user</td></tr>
        </table>

        <div class="help-callout">
          <strong>üí° Tip:</strong> For the Silent App Dashboard to appear, make sure you include the <code>audit.log</code> file ‚Äî the dashboard is powered by audit events (STARTUP, SHUTDOWN, START_TRACKING, etc.).
        </div>
      </div>

      <!-- SCREENSHOTS SECTION -->
      <div class="help-section" id="help-screenshots">
        <h3>Screenshot Health Analysis</h3>
        <p>The analyzer goes beyond counting screenshot events. It detects <strong>conditions that cause blank or black screenshots</strong> even when the upload process appears successful.</p>

        <h4>Why This Matters</h4>
        <p>When Hubstaff uploads a screenshot, the log shows "Uploading Screen" ‚Äî but this only means data was sent. It does <strong>not</strong> confirm the image has actual content. Without proper permissions, the image may be just the desktop wallpaper or completely black.</p>

        <h4>Risk Factors Detected</h4>
        <table class="help-table">
          <tr><th>Risk Factor</th><th>Severity</th><th>Meaning</th></tr>
          <tr><td>Screen Recording Permission Issue</td><td>üî¥ Critical</td><td>macOS permission denied ‚Äî all screenshots blank</td></tr>
          <tr><td>Helper Crashes Near Capture</td><td>üî¥ Critical</td><td>Helper crashed within 60s of capture</td></tr>
          <tr><td>Capture/Upload Failures</td><td>üî¥ Critical</td><td>Explicit errors in logs</td></tr>
          <tr><td>Screen Sleep During Tracking</td><td>üü° Warning</td><td>Monitor off while tracker active</td></tr>
          <tr><td>Security Software Detected</td><td>üü° Warning</td><td>McAfee, Norton, Webroot, VirtualBox, etc.</td></tr>
          <tr><td>Excessive Helper Crashes</td><td>üü° Warning</td><td>50+ crashes ‚Äî missed screenshots likely</td></tr>
          <tr><td>Upload Rate Limited</td><td>üü° Warning</td><td>HTTP 429 on /screens endpoint</td></tr>
          <tr><td>macOS No Permission Confirmation</td><td>üîµ Info</td><td>macOS device with no evidence permission was granted</td></tr>
        </table>

        <h4>Where Results Appear</h4>
        <ul>
          <li><strong>Screenshots section</strong> ‚Äî health panel at the top with stats and risk factor cards</li>
          <li><strong>Root Cause Analysis</strong> ‚Äî warns "Screenshots Uploading ‚Äî But May Be Blank" instead of false success</li>
          <li><strong>Silent App Dashboard</strong> ‚Äî Screenshots KPI card and health check</li>
        </ul>

        <h4>Resolution Steps</h4>
        <ol>
          <li>Check the <strong>Activity page</strong> in Hubstaff dashboard ‚Äî are screenshots actually blank?</li>
          <li><strong>macOS:</strong> System Settings ‚Üí Privacy & Security ‚Üí Screen & System Audio Recording ‚Üí toggle Hubstaff ON. May need quit & reopen.</li>
          <li><strong>Windows:</strong> Check for antivirus/web-shield software (McAfee, Norton, Webroot) or VirtualBox.</li>
          <li><strong>Sleep:</strong> Computer sleeping during tracking produces black screenshots.</li>
          <li><strong>Silent App:</strong> Distribute the <code>.mobileconfig</code> file before installation to pre-approve permissions.</li>
        </ol>

        <div class="help-callout warning">
          <strong>‚ö†Ô∏è Key Insight</strong><br>
          "Uploading Screen" in the log does NOT mean the screenshot is valid. Always verify on the Activity page if blank screenshots are reported.
        </div>
      </div>

      <!-- IDLE TIME SECTION -->
      <div class="help-section" id="help-idle">
        <h3>Idle Time Decisions Table</h3>
        <p>This table shows <strong>every idle prompt response</strong> with full details. Use it when a customer claims they clicked "Yes" to keep idle time.</p>
        
        <table class="help-table">
          <tr><th>Column</th><th>Description</th></tr>
          <tr><td><strong>Time</strong></td><td>When the user responded to the idle prompt</td></tr>
          <tr><td><strong>Idle Duration</strong></td><td>How long the user was idle before responding</td></tr>
          <tr><td><strong>Response Time</strong></td><td>How many seconds the user took to answer</td></tr>
          <tr><td><strong>User Action</strong></td><td>What the user chose (KEPT, DISCARDED, etc.)</td></tr>
          <tr><td><strong>Raw Values</strong></td><td>The actual KeepIdle/StopTracking values from the log</td></tr>
        </table>

        <h4>User Action Types</h4>
        <table class="help-table">
          <tr><th>Display</th><th>Raw Values</th><th>Meaning</th></tr>
          <tr><td>‚úÖ KEPT</td><td><code>KeepIdle: 1 / StopTracking: 0</code></td><td>User clicked YES to keep idle time</td></tr>
          <tr><td>‚ùå DISCARDED</td><td><code>KeepIdle: 0 / StopTracking: 0</code></td><td>User clicked NO but continued tracking</td></tr>
          <tr><td>üõë DISCARDED + STOPPED</td><td><code>KeepIdle: 0 / StopTracking: 1</code></td><td>User clicked NO and stopped tracking</td></tr>
        </table>

        <div class="help-callout warning">
          <strong>‚ö†Ô∏è 1-Hour Limit</strong><br>
          If idle duration exceeds 1 hour, a warning badge appears. Idle time over 1 hour <strong>cannot be kept</strong> regardless of user choice - this is a system limitation.
        </div>

        <h4>Investigating "I Clicked Yes But Time Wasn't Kept"</h4>
        <ol>
          <li>Find the date/time in the Idle Time Decisions table</li>
          <li>Check the <strong>Raw Values</strong> column</li>
          <li>If <code>KeepIdle: 1</code> ‚Üí Client recorded YES correctly. Issue is server-side.</li>
          <li>If <code>KeepIdle: 0</code> ‚Üí User actually clicked NO (or prompt timed out)</li>
          <li>If <strong>>1hr badge</strong> shows ‚Üí Time exceeded limit, can't be kept even with YES</li>
        </ol>
      </div>

      <!-- SESSIONS SECTION -->
      <div class="help-section" id="help-sessions">
        <h3>Tracking Sessions</h3>
        <p>The sessions table shows each START/STOP pair with duration and stop reason.</p>

        <h4>Stop Reasons</h4>
        <table class="help-table">
          <tr><th>Stop Reason</th><th>Meaning</th><th>Problem?</th></tr>
          <tr><td><strong>User stopped</strong></td><td>Normal stop, logged as user-initiated</td><td>No</td></tr>
          <tr><td><strong>Went idle</strong></td><td>Idle timeout triggered</td><td>No</td></tr>
          <tr><td><strong>‚ö†Ô∏è Crashed</strong></td><td>No stop event found, app likely crashed</td><td>Yes - investigate</td></tr>
          <tr><td><strong>Config/Limit</strong></td><td>Policy stopped tracking (time limit, schedule)</td><td>Check settings</td></tr>
          <tr><td><strong>üìç Left Job Site</strong></td><td>User exited geofenced area</td><td>Expected if rules active</td></tr>
          <tr><td><strong>App closed</strong></td><td>App was shut down normally</td><td>No</td></tr>
        </table>

        <div class="help-callout">
          <strong>What "User stopped" Does NOT Mean</strong><br>
          ‚ùå Does NOT mean the app crashed<br>
          ‚ùå Does NOT mean there was an error<br>
          ‚ùå Does NOT mean timezone issues caused it<br>
          If user disputes stopping manually: consider accidental click, trackpad sensitivity, or another person with access.
        </div>
      </div>

      <!-- JOB SITES SECTION -->
      <div class="help-section" id="help-jobsites">
        <h3>Job Site Analysis</h3>
        <p>When job site data is present, you'll see configured sites, user location, and visit history with map links.</p>

        <h4>Visit History</h4>
        <p>Each entry shows:</p>
        <ul>
          <li>User's GPS coordinates at the time</li>
          <li>Distance to nearest configured site</li>
          <li>Whether inside or outside the radius</li>
          <li><strong>Map links</strong> to view in Google Maps</li>
        </ul>

        <h4>Recommended Job Site Radius</h4>
        <table class="help-table">
          <tr><th>Scenario</th><th>Recommended Radius</th></tr>
          <tr><td>Outdoor work</td><td>50-100m</td></tr>
          <tr><td>Indoor office</td><td>100-150m</td></tr>
          <tr><td>Large facility</td><td>150-200m</td></tr>
          <tr><td>Poor GPS area</td><td>200m+</td></tr>
        </table>

        <div class="help-callout warning">
          <strong>‚ö†Ô∏è Radius ‚â§50m Warning</strong><br>
          Job sites with very small radii often fail due to GPS accuracy limitations, especially indoors.
        </div>

        <h4>Primary Device</h4>
        <p>Only the <strong>primary device</strong> can record locations and trigger job site automations. If you see "not primary" errors:</p>
        <ul>
          <li>User logged into a newer device, making the old one non-primary</li>
          <li>A banner should appear on Timer screen to "Make Primary"</li>
        </ul>
      </div>

      <!-- iOS SECTION -->
      <div class="help-section" id="help-ios">
        <h3>iOS Location Troubleshooting</h3>
        <h4>Required Settings</h4>
        <ol>
          <li><strong>Location Services:</strong> Settings ‚Üí Privacy & Security ‚Üí Location Services ‚Üí ON</li>
          <li><strong>Hubstaff Permission:</strong> Settings ‚Üí Hubstaff ‚Üí Location ‚Üí <code>Always</code></li>
          <li><strong>Precise Location:</strong> Settings ‚Üí Hubstaff ‚Üí Precise Location ‚Üí ON</li>
          <li><strong>Background Refresh:</strong> Settings ‚Üí General ‚Üí Background App Refresh ‚Üí Hubstaff ‚Üí ON</li>
        </ol>

        <div class="help-callout danger">
          <strong>‚ö†Ô∏è "While Using" Is NOT Sufficient</strong><br>
          Hubstaff requires "Always" permission to track locations in the background. "While Using" will cause job sites to fail.
        </div>

        <h4>Common iOS Log Patterns</h4>
        <table class="help-table">
          <tr><th>Pattern</th><th>Meaning</th></tr>
          <tr><td><code>kCLErrorDomain Code=1</code></td><td>Location permission denied</td></tr>
          <tr><td><code>kCLErrorDomain Code=0</code></td><td>Location unknown/unavailable</td></tr>
          <tr><td><code>Background Refresh: OFF</code></td><td>Background app refresh disabled</td></tr>
        </table>
      </div>

      <!-- ANDROID SECTION -->
      <div class="help-section" id="help-android">
        <h3>Android Location Troubleshooting</h3>
        <h4>Required Settings</h4>
        <ol>
          <li><strong>Location Permission:</strong> Settings ‚Üí Apps ‚Üí Hubstaff ‚Üí Permissions ‚Üí Location ‚Üí "Allow all the time"</li>
          <li><strong>Location Mode:</strong> Enable "High accuracy" mode</li>
          <li><strong>Battery Optimization:</strong> Settings ‚Üí Apps ‚Üí Hubstaff ‚Üí Battery ‚Üí "Unrestricted"</li>
        </ol>

        <h4>Brand-Specific Battery Settings (CRITICAL)</h4>
        <table class="help-table">
          <tr><th>Brand</th><th>Steps</th></tr>
          <tr><td><strong>Samsung</strong></td><td>Device Care ‚Üí Battery ‚Üí App power management ‚Üí Hubstaff ‚Üí Unrestricted. Remove from "Sleeping apps" AND "Deep sleeping apps"</td></tr>
          <tr><td><strong>Xiaomi/MIUI</strong></td><td>Apps ‚Üí Manage Apps ‚Üí Hubstaff ‚Üí Autostart ON. Battery ‚Üí Hubstaff ‚Üí No restrictions</td></tr>
          <tr><td><strong>Huawei</strong></td><td>Battery ‚Üí App Launch ‚Üí Hubstaff ‚Üí Manually Manage with all toggles ON</td></tr>
          <tr><td><strong>OnePlus</strong></td><td>Battery ‚Üí Battery Optimization ‚Üí Hubstaff ‚Üí Don't optimize</td></tr>
          <tr><td><strong>OPPO/Realme</strong></td><td>App Management ‚Üí Hubstaff ‚Üí Allow Auto-start + disable battery optimization</td></tr>
        </table>

        <h4>Common Android Log Patterns</h4>
        <table class="help-table">
          <tr><th>Pattern</th><th>Meaning</th></tr>
          <tr><td><code>isIgnoringBatteryOptimization: false</code></td><td>Battery optimization is ON (bad)</td></tr>
          <tr><td><code>BACKGROUND_LOCATION enabled=false</code></td><td>Background location not granted</td></tr>
          <tr><td><code>TRACKING_NOT_STARTED</code></td><td>Timer blocked - not at required job site</td></tr>
          <tr><td><code>non-primary device</code></td><td>Different device is set as primary</td></tr>
        </table>
      </div>

      <!-- DESKTOP SECTION -->
      <div class="help-section" id="help-desktop">
        <h3>Windows/Mac/Linux Desktop</h3>
        <h4>Common Issues</h4>
        <table class="help-table">
          <tr><th>Pattern</th><th>Meaning</th><th>Solution</th></tr>
          <tr><td><code>main_watchdog hit</code></td><td>App froze/became unresponsive</td><td>Check system resources, restart app</td></tr>
          <tr><td><code>Helper died</code></td><td>Helper process crashed (affects screenshots, app/URL detection)</td><td>Check for antivirus interference, update app version</td></tr>
          <tr><td><code>Response: 401</code></td><td>Authentication failed</td><td>User needs to re-login</td></tr>
          <tr><td><code>Could not resolve host</code></td><td>No internet connection</td><td>Check network connectivity</td></tr>
          <tr><td><code>Response: 429</code></td><td>Rate limited ‚Äî too many requests</td><td>Usually temporary; may affect screenshot uploads</td></tr>
        </table>

        <h4>Blank / Black Screenshots</h4>
        <p>If a user reports that screenshots appear blank, black, or show only the desktop wallpaper:</p>
        <table class="help-table">
          <tr><th>Platform</th><th>Common Cause</th><th>Fix</th></tr>
          <tr><td><strong>macOS</strong></td><td>Screen Recording permission not granted</td><td>System Settings ‚Üí Privacy & Security ‚Üí Screen & System Audio Recording ‚Üí Hubstaff ON. Quit & reopen.</td></tr>
          <tr><td><strong>Windows</strong></td><td>Antivirus / web-shield software</td><td>Temporarily disable McAfee, Norton, Webroot to test. Whitelist Hubstaff if that fixes it.</td></tr>
          <tr><td><strong>Any</strong></td><td>Computer sleeping while tracking</td><td>Screenshots at the moment of sleep will be black. This is expected behaviour.</td></tr>
          <tr><td><strong>Any</strong></td><td>VirtualBox / VMware running</td><td>Virtual machine software can interfere with screen capture</td></tr>
        </table>
        <p>The analyzer's <strong>Screenshot Health Analysis</strong> (see the Screenshots tab) will detect these risk factors automatically.</p>

        <h4>Brave Browser</h4>
        <div class="help-callout warning">
          <strong>‚ö†Ô∏è URL Tracking Not Supported in Brave</strong><br>
          Hubstaff cannot track URLs in Brave Browser. The app name will be tracked, but visited URLs will not appear in reports. For URL tracking, use Chrome, Edge, Firefox, or Island Browser.
        </div>

        <h4>Mac Permissions</h4>
        <p>If URL, screenshot, or app tracking isn't working on Mac:</p>
        <ul>
          <li><strong>Screen & System Audio Recording:</strong> System Settings ‚Üí Privacy & Security ‚Üí Screen & System Audio Recording ‚Üí Enable Hubstaff</li>
          <li><strong>Accessibility:</strong> System Settings ‚Üí Privacy & Security ‚Üí Accessibility ‚Üí Enable Hubstaff</li>
          <li><strong>Automation:</strong> System Settings ‚Üí Privacy & Security ‚Üí Automation ‚Üí Enable Hubstaff for browsers</li>
        </ul>
        <div class="help-callout">
          <strong>üí° Silent App on Mac</strong><br>
          For corporate deployments, distribute the <code>.mobileconfig</code> file before installing the silent app to pre-approve Screen Recording and Accessibility permissions. Without it, an admin must grant permissions manually on each machine.
        </div>
      </div>

      <!-- LOG PATTERNS SECTION -->
      <div class="help-section" id="help-patterns">
        <h3>Key Log Patterns Cheat Sheet</h3>
        <table class="help-table">
          <tr><th>Pattern</th><th>Meaning</th></tr>
          <tr><td><code>[ERROR]</code></td><td>Something went wrong</td></tr>
          <tr><td><code>[WARN]</code></td><td>Potential issue</td></tr>
          <tr><td><code>main_watchdog hit</code></td><td>App froze</td></tr>
          <tr><td><code>Helper died</code></td><td>Helper process crashed (affects screenshots, app/URL detection)</td></tr>
          <tr><td><code>Response: 4xx</code></td><td>Client error (auth, not found)</td></tr>
          <tr><td><code>Response: 5xx</code></td><td>Server error (outage)</td></tr>
          <tr><td><code>Response: 429</code></td><td>Rate limited ‚Äî too many requests</td></tr>
          <tr><td><code>Discard=1</code></td><td>Time was rejected</td></tr>
          <tr><td><code>STARTUP_CLEAN</code></td><td>App started normally</td></tr>
          <tr><td><code>STARTUP_UNCLEAN</code></td><td>App crashed or was killed previously</td></tr>
          <tr><td><code>KeepIdle: 1</code></td><td>User chose to keep idle time</td></tr>
          <tr><td><code>KeepIdle: 0</code></td><td>User chose to discard idle time</td></tr>
          <tr><td><code>Uploading Screen</code></td><td>Screenshot uploading (doesn't confirm it's valid)</td></tr>
          <tr><td><code>CAPTURE_DESKTOP "No monitors detected"</code></td><td>Screen sleep / monitor off</td></tr>
          <tr><td><code>CORPORATE_PROVISION_ATTEMPT_FAILED</code></td><td>Silent app auth failure</td></tr>
          <tr><td><code>Simulating missed input</code></td><td>Hardware not recognised ‚Äî input simulated</td></tr>
          <tr><td><code>Could not resolve host</code></td><td>No internet connection (DNS failure)</td></tr>
        </table>

        <h3>Plain English Translations</h3>
        <p>When Plain English mode is enabled, common patterns are translated:</p>
        <table class="help-table">
          <tr><th>Technical Log</th><th>Plain English</th></tr>
          <tr><td><code>main_watchdog hit</code></td><td>‚ö†Ô∏è The app froze or became unresponsive</td></tr>
          <tr><td><code>Helper died</code></td><td>üîå The helper process crashed</td></tr>
          <tr><td><code>Response: 401</code></td><td>üîê Authentication failed - user may be logged out</td></tr>
          <tr><td><code>kCLErrorDomain Code=1</code></td><td>üìç iOS Location Permission Denied</td></tr>
          <tr><td><code>TRACKING_NOT_STARTED</code></td><td>üö´ Timer Blocked - Not At Required Job Site</td></tr>
          <tr><td><code>Uploading Screen</code></td><td>üì∏ Screenshot uploading ‚Äî does not confirm image is valid</td></tr>
          <tr><td><code>Wrote ScreenData</code></td><td>üì∏ Screenshot data written locally ‚Äî upload pending</td></tr>
          <tr><td><code>Simulating missed input</code></td><td>üîß Hardware not recognised ‚Äî input simulated</td></tr>
        </table>

        <h3>Workflow for Log Analysis</h3>
        <ol>
          <li>Upload log files (drag & drop multiple for best results)</li>
          <li>Check <strong>Root Cause Analysis</strong> box first (if Plain English mode is on)</li>
          <li>Check <strong>Silent App Dashboard</strong> if it appears (corporate/enterprise)</li>
          <li>Review <strong>Quick Summary</strong> for prioritised findings</li>
          <li>Check <strong>Screenshot Health</strong> if blank screenshots are reported</li>
          <li>Check <strong>Device Dashboard</strong> (Android) for permission/setting issues</li>
          <li>Review <strong>Tracking Sessions</strong> to understand what was tracked</li>
          <li>Check <strong>Idle Time Decisions</strong> if user disputes idle choices</li>
          <li>Use <strong>Search</strong> for specific patterns if needed</li>
          <li>Check <strong>Visit History</strong> for job site issues with map links</li>
        </ol>
      </div>

    </div>
  </div>

  <script src="js/utils.js"></script>
  <script src="js/device-dashboard.js"></script>
  <script src="js/summary.js"></script>
  <script src="js/analyzer.js"></script>
  <script src="js/silent-app.js"></script>
  <script src="js/render.js"></script>
  <script src="js/file-upload.js"></script>
</body>
</html>
